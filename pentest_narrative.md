# Internal Pentest Narrative
Template for an internal penetration test narrative section.

## Discovery
The assessor began the assessment by connecting to the network via {{method of connecting to the network}}. This provided access to the {{VLAN ID or subnet}} with an IP of {{IP}} on the local network.

By examining the information provided in the `/etc/resolv.conf` file, the assessor was able to identify DNS information. In a network managed by Active Directory (AD), oftentimes the AD domain is populated as the search domain by DHCP. This file listed {{`domain`}} as the search domain for the local network.

```
cat /etc/resolv.conf
```

## Enumeration & Vulnerability Mapping

With access to the local internal network established, the assessor attempted to idenify traffic on the LAN such as Link Local Multicast Name Resolution (LLMNR) and NetBIOS Name Resolution (NBNS) that could be spoofed. If a target device uses these broadcast protocols, an attacker can exploit this scenario by responding to these requests with malicious data. Under certain conditions, this can result in the victim computer authenticating to the attacker's device. This authentication attempt can be relayed to a server or extracted password hashes can be subjected to an offline cracking attempt. The assessor identified {{a large amount of LLMNR and NBNS traffic}}.

```
responder -I eth0 -wrfFPb
```

The assessor next attempted a second LAN atttack, DHCPv6 poisoning using `mitm6`. Windows operating system releases since Vista prefer IPv6 over IPv4; as a result, Windows will by default send out a DHCPv6 request by default when connecting to a network. An attacker can abuse this by responding to this broadcast request and configure an attacking device as the DNS server in the response. If successful, the attacker receives control of the victim's DNS and authentication attacks can be attempted in similar fashion to the `responder` attack.

```
mitm6 -d tktk.domain
ntlmrelayx.py -6 -wh pscfirst.tktk.domain -tf hosts-no-signing.lst -l loot/ -debug
```

The assessor then began to gather additional network information by scanning the target network with `nmap`, a port scanning scanning tool that attempts to connect to systems on specified ports to determine open ports, service banners, and even common vulnerabilities.

```
nmap -iL corp.lst -sVC --open -oA scans/nmap-default-sVC --min-hostgroup=128 --max-retries=1 -v
```
